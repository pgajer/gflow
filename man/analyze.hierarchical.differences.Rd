% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/stats_utils.R
\name{analyze.hierarchical.differences}
\alias{analyze.hierarchical.differences}
\title{Perform Hierarchical Bayesian Analysis of Method Differences}
\usage{
analyze.hierarchical.differences(bb.integrals)
}
\arguments{
\item{bb.integrals}{A named list of Bayesian bootstrap integral values, where each element
contains numeric samples representing the performance metric for a method. All elements
must have the same length.}
}
\value{
A stanfit object containing:
\itemize{
\item \code{mu}: Posterior samples of method-specific means
\item \code{sigma}: Posterior samples of method-specific standard deviations
\item \code{tau}: Posterior samples of between-method variability
\item \code{global_mu}: Posterior samples of the overall mean across methods
\item \code{diff}: Matrix of pairwise differences (mu[i] - mu[j])
\item \code{prob_diff}: Matrix of probabilities that method i is worse than method j
}
}
\description{
Fits a hierarchical Bayesian model to compare multiple methods, estimating method-specific
means and variances while accounting for between-method variability. The model provides
posterior distributions for all pairwise method differences and probabilities of superiority.
}
\details{
The hierarchical model structure:
\itemize{
\item Method means: \code{mu[k] ~ Normal(global_mu, tau)}
\item Observations: \code{y[n,k] ~ Normal(mu[k], sigma[k])}
\item Priors: \code{global_mu ~ Normal(0, 10)}, \code{tau ~ Cauchy(0, 2.5)},
\code{sigma ~ Cauchy(0, 2.5)}
\item The model pools information across methods through the hierarchical structure
}
}
\note{
\itemize{
\item Requires the 'rstan' package to be installed
\item Uses 4 chains with 2000 iterations (1000 warmup, 1000 sampling)
\item \code{prob_diff\[i,j\]} represents P(mu[i] < mu[j]), so values < 0.5 indicate method i is better
\item Check convergence using \code{rstan::check_hmc_diagnostics()} and \code{summary()}
}
}
\examples{
\dontrun{
# Example: Compare three methods with hierarchical model
set.seed(123)
bb.integrals <- list(
  method_A = rnorm(100, mean = 0.5, sd = 0.1),
  method_B = rnorm(100, mean = 0.52, sd = 0.12),
  method_C = rnorm(100, mean = 0.48, sd = 0.08)
)

# Fit hierarchical model
fit <- analyze.hierarchical.differences(bb.integrals)

# Check convergence
rstan::check_hmc_diagnostics(fit)

# Extract posterior summaries
print(fit, pars = c("mu", "sigma", "tau"))

# Get pairwise probabilities
prob_matrix <- rstan::extract(fit, "prob_diff")$prob_diff
apply(prob_matrix, c(2,3), mean)  # Mean probabilities
}
}
\references{
Gelman, A., & Hill, J. (2007). Data analysis using regression and
multilevel/hierarchical models. Cambridge University Press.
}
\seealso{
\code{\link[rstan]{stan}} for model fitting,
\code{\link[rstan]{extract}} for extracting posterior samples,
\code{\link[rstan]{check_hmc_diagnostics}} for convergence diagnostics
}
