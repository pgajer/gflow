% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/iknn_graphs.R
\name{find.optimal.k}
\alias{find.optimal.k}
\title{Find Optimal k Parameter Using Edge Persistence Analysis}
\usage{
find.optimal.k(birth.death.matrix, kmin, kmax, matrix_type = "geom")
}
\arguments{
\item{birth.death.matrix}{A numeric matrix with columns "birth_time" and "death_time"
containing the birth and death times of edges. Each row represents one edge.
For edges that persist through kmax, death_time equals kmax + 1.}

\item{kmin}{The minimum k value to consider}

\item{kmax}{The maximum k value to consider}

\item{matrix_type}{Character string describing the type of matrix (default: "geom").
Used for informative warning messages.}
}
\value{
A list containing:
\describe{
\item{stability.scores}{Numeric vector of stability scores for each k value}
\item{k.values}{Vector of k values analyzed (kmin:kmax)}
\item{opt.k}{The k value with highest stability score}
}
}
\description{
Analyzes the stability of graph structures across different k values by examining
the persistence patterns of edges. The function combines multiple stability metrics
to identify the k value that produces the most stable graph structure.
}
\details{
The function calculates stability scores for each k value using three components:
\enumerate{
\item Average persistence (lifetime) of edges present at k
\item Proportion of persistent edges (those that continue to kmax+1)
\item Edge stability measure that penalizes recently born or soon-to-die edges
}

The final stability score for each k is the product of these three components.
Higher scores indicate more stable graph structures.
}
\examples{
\dontrun{
# Assuming we have birth-death data from create.iknn.graphs()
result <- create.iknn.graphs(X, kmin = 3, kmax = 10)

# Find optimal k
stability <- find.optimal.k(result$birth_death_matrix, kmin = 3, kmax = 10)

# Plot stability scores
plot(stability$k.values, stability$stability.scores, type = "l",
     xlab = "k", ylab = "Stability Score")
abline(v = stability$opt.k, col = "red", lty = 2)
}

}
\seealso{
\code{\link{create.iknn.graphs}} for generating the birth-death matrix
}
