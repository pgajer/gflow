% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/graph_kernel_smoother.R
\name{estimate.optimal.bandwidth.from.extrema.elbow}
\alias{estimate.optimal.bandwidth.from.extrema.elbow}
\title{Estimate Optimal Bandwidth Using Local Extrema Count Elbow Method}
\usage{
estimate.optimal.bandwidth.from.extrema.elbow(
  extrema.counts,
  sd.multiplier = 1,
  plot.results = FALSE
)
}
\arguments{
\item{extrema.counts}{A numeric vector of local extrema counts corresponding
to different bandwidths, ordered from smallest to largest bandwidth. Must
contain at least 5 values.}

\item{sd.multiplier}{The number of residual standard deviations to add to
the elbow point. Must be non-negative. Default is 1.0.}

\item{plot.results}{Logical. If \code{TRUE}, produces a diagnostic plot
showing the fitted model and selected bandwidth. Default is \code{FALSE}.}
}
\value{
An integer representing the index of the estimated optimal bandwidth
in the input vector.
}
\description{
Estimates the optimal bandwidth for kernel smoothing by analyzing the
relationship between bandwidth and the number of local extrema. The method
identifies an "elbow point" in this relationship using piecewise linear
regression and adjusts it based on model residuals.
}
\details{
The number of local extrema in a kernel-smoothed function typically decreases
as bandwidth increases, often exhibiting an elbow-shaped curve. This function:

\enumerate{
\item Fits a piecewise linear model to the extrema counts
\item Identifies the breakpoint (elbow) in the relationship
\item Adds a specified multiple of the residual standard deviation to the
breakpoint location
}

The optimal bandwidth is often slightly beyond the elbow point, as the exact
elbow typically represents the transition from undersmoothing to appropriate
smoothing.
}
\examples{
# Simulated extrema counts for increasing bandwidths
extrema.counts <- c(150, 142, 128, 95, 72, 58, 45, 38, 35, 33, 32, 31)

# Estimate optimal bandwidth
opt.idx <- estimate.optimal.bandwidth.from.extrema.elbow(
  extrema.counts,
  sd.multiplier = 1.5,
  plot.results = TRUE
)

print(paste("Optimal bandwidth index:", opt.idx))

}
\references{
Muggeo, V. M. (2003). Estimating regression models with unknown break-points.
\emph{Statistics in Medicine}, 22(19), 3055-3071.
}
\seealso{
\code{\link{graph.kernel.smoother}} for the main smoothing function.
}
