% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_utils.R
\name{plot3D.cltrs}
\alias{plot3D.cltrs}
\title{Create 3D Plot with Cluster Visualization}
\usage{
plot3D.cltrs(
  X,
  cltr = NULL,
  cltr.col.tbl = NULL,
  ref.cltr = NULL,
  ref.cltr.color = "gray",
  show.ref.cltr = TRUE,
  show.cltr.labels = FALSE,
  add = FALSE,
  title = "",
  cex.labs = 2,
  pal.type = "numeric",
  brewer.pal.n = 3,
  brewer.pal = "Set1",
  open.3d = FALSE,
  show.legend = TRUE,
  sort.legend.labs.by.freq = FALSE,
  sort.legend.labs.by.name = FALSE,
  filter.out.freq.0.cltrs = TRUE,
  legend.title = NULL,
  radius = NA,
  axes = FALSE,
  xlab = "",
  ylab = "",
  zlab = "",
  use.null = TRUE,
  ...
)
}
\arguments{
\item{X}{A 3D matrix or data.frame with exactly 3 columns.}

\item{cltr}{A vector of cluster IDs (numeric or character) of length nrow(X).}

\item{cltr.col.tbl}{A named vector mapping cluster IDs to colors. If NULL, colors are assigned automatically.}

\item{ref.cltr}{A reference cluster ID (usually '0') that can be colored differently.}

\item{ref.cltr.color}{The color for the reference cluster.}

\item{show.ref.cltr}{Logical. Whether to display the reference cluster.}

\item{show.cltr.labels}{Logical. Whether to show cluster labels in the plot.}

\item{add}{Logical. Whether to add to an existing plot.}

\item{title}{Title of the plot.}

\item{cex.labs}{Size scaling parameter for cluster labels.}

\item{pal.type}{Palette type: "numeric", "brewer", or "mclust".}

\item{brewer.pal.n}{Number of colors in the RColorBrewer palette.}

\item{brewer.pal}{Name of the RColorBrewer palette.}

\item{open.3d}{Logical. Whether to open a new 3D window.}

\item{show.legend}{Logical. Whether to show the legend.}

\item{sort.legend.labs.by.freq}{Logical. Sort legend labels by frequency.}

\item{sort.legend.labs.by.name}{Logical. Sort legend labels alphabetically.}

\item{filter.out.freq.0.cltrs}{Logical. Remove clusters with zero frequency from legend.}

\item{legend.title}{Title for the legend.}

\item{radius}{Numeric. Size of spheres at data points.}

\item{axes}{Logical. Whether to show axes.}

\item{xlab, ylab, zlab}{Axis labels.}

\item{use.null}{Logical. If TRUE, forces use of the RGL null device for safe operation in headless or CI environments.}

\item{...}{Additional arguments passed to \code{\link[rgl]{plot3d}}.}
}
\value{
Invisibly returns a list containing:
\item{ids}{RGL object IDs}
\item{cltr.col.tbl}{Color table used for clusters}
\item{cltr.labs}{Cluster labels}
\item{legend.cltr.labs}{Legend labels}
\item{cltr.centers}{Matrix of cluster centers (if show.cltr.labels = TRUE)}
}
\description{
Creates a 3D plot of points with cluster assignments shown by different colors
}
\details{
This function provides comprehensive cluster visualization in 3D space with automatic
color assignment, legend generation, and various customization options. It supports
highlighting specific clusters and different color palette options.
}
\examples{
\dontrun{
if (requireNamespace("rgl", quietly = TRUE)) {
  old <- options(rgl.useNULL = TRUE); on.exit(options(old), add = TRUE)
  set.seed(123)
  X <- matrix(rnorm(300), ncol = 3)
  cltr <- sample(c("A", "B", "C"), 100, replace = TRUE)
  plot3D.cltrs(X, cltr, show.cltr.labels = TRUE)
}
}
}
