% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/stats_utils.R
\name{gaussian.second.derivative}
\alias{gaussian.second.derivative}
\title{Calculate Second Derivative of Gaussian Function}
\usage{
gaussian.second.derivative(x, mu, sd)
}
\arguments{
\item{x}{Numeric vector of x values at which to evaluate the second derivative}

\item{mu}{Mean parameter (location) of the Gaussian function}

\item{sd}{Standard deviation parameter (scale) of the Gaussian function. Must be positive.}
}
\value{
Numeric vector of second derivative values with the same length as x. The second
derivative equals zero at the inflection points (x = mu ± sd), is negative between
them (concave down), and positive outside them (concave up).
}
\description{
This function computes the second derivative of the unnormalized Gaussian function:
\deqn{f(x) = \exp\left(-\frac{(x - \mu)^2}{2\sigma^2}\right)}{f(x) = exp(-((x - mu)^2)/(2 * sd^2))}
with respect to x. The second derivative identifies inflection points of the Gaussian
curve, which occur at \eqn{\mu \pm \sigma}{mu ± sd}.
}
\details{
The second derivative is computed using the formula:
\deqn{f''(x) = \frac{(z^2 - 1) \cdot \exp(-z^2/2)}{\sigma^2}}{f''(x) = (z^2 - 1) * exp(-z^2/2) / sd^2}
where \eqn{z = (x - \mu)/\sigma}{z = (x - mu)/sd} is the standardized value.

Key properties:
\itemize{
\item Zero at x = mu ± sd (inflection points)
\item Maximum at x = mu (where f''(mu) = -1/sd^2)
\item Approaches 0 as \eqn{x \to \pm \infty}
}
}
\note{
This computes the second derivative of the unnormalized Gaussian (without the
\eqn{1/(\sigma\sqrt{2\pi})}{1/(sd*sqrt(2*pi))} normalization factor). For the
normalized version, multiply the result by \eqn{1/(\sigma\sqrt{2\pi})}{1/(sd*sqrt(2*pi))}.
}
\examples{
# Example 1: Basic usage
x <- seq(-5, 5, length.out = 100)
result <- gaussian.second.derivative(x, mu = 0, sd = 1)

# Example 2: Verify inflection points at mu ± sd
mu <- 2
sd <- 1.5
x_inflection <- c(mu - sd, mu + sd)
gaussian.second.derivative(x_inflection, mu, sd)  # Should be ~0

# Example 3: Visualize the Gaussian and its second derivative
x <- seq(-4, 4, length.out = 200)
f <- exp(-(x^2)/2)  # Original function (mu=0, sd=1)
f_double_prime <- gaussian.second.derivative(x, mu = 0, sd = 1)

par(mfrow = c(2, 1))
plot(x, f, type = "l", main = "Gaussian Function", ylab = "f(x)")
abline(v = c(-1, 1), col = "red", lty = 2)  # Inflection points
plot(x, f_double_prime, type = "l", main = "Second Derivative", ylab = "f''(x)")
abline(h = 0, col = "gray")
abline(v = c(-1, 1), col = "red", lty = 2)  # Zero crossings
}
\seealso{
\code{\link{dnorm}} for the normalized Gaussian density function,
\code{\link{find.inflection.pts}} for finding inflection points in general curves
}
