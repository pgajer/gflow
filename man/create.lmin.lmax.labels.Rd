% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/graph_MS_cx.R
\name{create.lmin.lmax.labels}
\alias{create.lmin.lmax.labels}
\title{Create Labels for Local Maxima and Minima in Morse-Smale Complex}
\usage{
create.lmin.lmax.labels(
  MS.res,
  state.space,
  taxonomy,
  freq.thld = 100,
  min.relAb.thld = 0.05
)
}
\arguments{
\item{MS.res}{A list containing Morse-Smale complex results with component MS_cx}

\item{state.space}{Matrix of ASV counts/abundances with samples as columns and ASVs as rows}

\item{taxonomy}{Taxonomy information for ASVs}

\item{freq.thld}{Threshold for frequency filtering (default: 100)}

\item{min.relAb.thld}{Minimum relative abundance threshold for including taxa in labels (default: 0.05)}
}
\value{
A list with four components:
\item{lmax.labels}{Named character vector of local maxima labels}
\item{lmin.labels}{Named character vector of local minima labels}
\item{lmax.profiles}{Named list of relative abundance profiles for local maxima, where names are point indices and each profile is a matrix with taxa in rows and two columns: species names and their relative abundances}
\item{lmin.profiles}{Named list of relative abundance profiles for local minima, where names are point indices and each profile is a matrix with taxa in rows and two columns: species names and their relative abundances}
}
\description{
Creates unique labels for local maxima and minima in a Morse-Smale complex by
concatenating two-letter shortcuts of the most abundant taxa. The function ensures
uniqueness of labels by iteratively including additional taxa if needed.
}
\details{
The function processes both local maxima and minima, creating unique labels by:
\enumerate{
\item Filtering points by frequency threshold
\item For each point, identifying taxa above the relative abundance threshold
\item Creating initial labels using two-letter shortcuts
\item Ensuring uniqueness by incorporating additional taxa if needed
}
}
\examples{
\dontrun{
labels <- create.lmin.lmax.labels(MS.res, state.space, taxonomy,
                                  freq.thld = 100, min.relAb.thld = 0.05)
print(labels$lmax.labels)
print(labels$lmin.labels)
}
}
