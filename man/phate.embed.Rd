% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/phate_core.R
\name{phate.embed}
\alias{phate.embed}
\title{Embed Diffusion-Potential Distances into 2D/3D Coordinates}
\usage{
phate.embed(
  core = NULL,
  D.pot = NULL,
  U.pot = NULL,
  ndim = 2L,
  method = c("metric_mds", "nonmetric_mds"),
  maxit = 200L,
  tol = 0.001,
  cmdscale.add = TRUE,
  seed = NULL,
  verbose = FALSE
)
}
\arguments{
\item{core}{Optional object returned by \code{\link{phate.core}}.}

\item{D.pot}{Optional diffusion-potential distance matrix (or \code{dist}).}

\item{U.pot}{Optional diffusion-potential coordinate matrix. Used when
\code{D.pot} is not provided.}

\item{ndim}{Embedding dimension (typically 2 or 3).}

\item{method}{Character: \code{"metric_mds"} or \code{"nonmetric_mds"}.}

\item{maxit}{Positive integer maximum iterations for non-metric MDS.}

\item{tol}{Positive convergence tolerance for non-metric MDS.}

\item{cmdscale.add}{Logical; passed to \code{stats::cmdscale(add = ...)}.}

\item{seed}{Optional integer seed (used for random fallback initialization).}

\item{verbose}{Logical; print progress messages.}
}
\value{
A list of class \code{"phate_embedding"} with:
\describe{
\item{embedding}{Numeric matrix (\code{n x ndim}) of embedded coordinates.}
\item{method}{Embedding method used.}
\item{stress}{Normalized distance reconstruction stress.}
\item{stress_raw}{Raw non-metric stress from \code{isoMDS} (if applicable).}
\item{cor_spearman}{Spearman correlation between input and embedded distances.}
\item{diagnostics}{List with method-specific diagnostics.}
\item{call}{Matched call.}
}
}
\description{
Computes a low-dimensional embedding from PHATE diffusion-potential geometry
using either metric MDS (\code{cmdscale}) or non-metric MDS
(\code{MASS::isoMDS}).
}
\examples{
\dontrun{
set.seed(1)
X <- matrix(rnorm(120), ncol = 3)
core <- phate.core(X = X, t = "auto", t.max = 20)
emb <- phate.embed(core = core, ndim = 2, method = "metric_mds")
emb$stress
}

}
