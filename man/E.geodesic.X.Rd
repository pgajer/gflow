% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/geodesics.R
\name{E.geodesic.X}
\alias{E.geodesic.X}
\title{Estimate Mean Abundance Along a Geodesic}
\usage{
E.geodesic.X(
  X,
  strand.ids,
  dist.along.strand.geodesic,
  data.dir,
  winsorize = TRUE,
  winsorize.p = 0.025,
  min.max.normalize = TRUE,
  prev.thld = 0.9,
  min.sample.count = 40,
  rerun = FALSE,
  n.partitions = 1,
  partition.i = 1,
  verbose = TRUE
)
}
\arguments{
\item{X}{A numeric matrix of covariates with samples as rows and variables as columns.
Row names should contain sample IDs.}

\item{strand.ids}{Character vector of sample IDs belonging to the strand.}

\item{dist.along.strand.geodesic}{Numeric vector of distances along the geodesic
for each sample in the strand. Names should correspond to sample IDs.}

\item{data.dir}{Character string specifying the directory path where results
will be saved.}

\item{winsorize}{Logical. If \code{TRUE} (default), performs right winsorization
on columns of \code{X} before normalization.}

\item{winsorize.p}{Numeric value between 0 and 1. Proportion of values at the
right tail to winsorize. Values above the (1 - \code{winsorize.p}) quantile
are set to that quantile value. Default is 0.025.}

\item{min.max.normalize}{Logical. If \code{TRUE} (default), applies min-max
normalization to each column of \code{X}.}

\item{prev.thld}{Numeric value between 0 and 1. Prevalence threshold for column
filtering. Only columns with non-zero values in at least \code{prev.thld}
proportion of samples are retained. Default is 0.9.}

\item{min.sample.count}{Integer. Minimum number of samples required in common
between \code{X} and the strand to proceed with analysis. Default is 40.}

\item{rerun}{Logical. If \code{TRUE}, reruns \code{fassoc1.test()} even if
results already exist. Default is \code{FALSE}.}

\item{n.partitions}{Integer. Number of partitions to split the column processing
into. Useful for parallel processing. Default is 1.}

\item{partition.i}{Integer. Index of the partition to process when
\code{n.partitions > 1}. Must be between 1 and \code{n.partitions}.}

\item{verbose}{Logical. If \code{TRUE} (default), prints progress messages
during execution.}
}
\value{
A list with the following components:
\item{X}{The processed matrix after sample and column filtering, with
optional winsorization and normalization applied.}
\item{dist.along.strand.geodesic}{Numeric vector of geodesic distances
for the samples common to both \code{X} and the strand.}
\item{data.dir}{Character string of the data directory path.}
\item{save.files}{Named character vector mapping standardized column names
to file paths where results are saved.}
\item{name.tbl}{Named character vector mapping standardized column names
to original column names from \code{X}.}
}
\description{
Estimates the mean abundance of covariates along a geodesic path. Given a matrix
of covariates defined over a subset of samples from the state space containing
the strand, this function estimates the mean of each column as a function of
distance along the geodesic for columns meeting prevalence criteria. Results
are saved to the specified data directory.
}
\details{
The function performs the following steps:
\enumerate{
\item Identifies samples common to both \code{X} and \code{strand.ids}
\item Filters columns based on the prevalence threshold
\item Optionally applies winsorization and normalization
\item Runs \code{fassoc1.test()} on each retained column
\item Saves results to individual files in the specified directory
}

When \code{n.partitions > 1}, the function processes only a subset of columns
specified by \code{partition.i}, enabling distributed computation.
}
\note{
Results for each column are saved as RDA files in \code{data.dir} with
filenames based on column indices. Each file contains \code{Ey} (expected
values) and \code{pval} (p-value) from \code{fassoc1.test()}.
}
\examples{
\dontrun{
# Create example data
set.seed(123)
X <- matrix(rnorm(1000), nrow=100, ncol=10)
rownames(X) <- paste0("sample", 1:100)
colnames(X) <- paste0("var", 1:10)

# Define strand
strand.ids <- paste0("sample", 1:80)
dist.along.strand.geodesic <- seq(0, 1, length.out=80)
names(dist.along.strand.geodesic) <- strand.ids

# Run analysis
result <- E.geodesic.X(X = X,
                       strand.ids = strand.ids,
                       dist.along.strand.geodesic = dist.along.strand.geodesic,
                       data.dir = tempdir(),
                       prev.thld = 0.5)

# Check results
str(result)
}

}
\seealso{
\code{\link{fassoc1.test}}, \code{\link{right.winsorize}},
\code{\link{minmax.normalize}}
}
