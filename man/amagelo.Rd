% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/amagelo.R
\name{amagelo}
\alias{amagelo}
\title{Adaptive Model Averaged GEodesic LOcal linear smoothing}
\usage{
amagelo(
  x,
  y,
  grid.size,
  min.bw.factor,
  max.bw.factor,
  n.bws,
  use.global.bw.grid = TRUE,
  with.bw.predictions = FALSE,
  log.grid = FALSE,
  domain.min.size = 4,
  kernel.type = 7L,
  dist.normalization.factor = 1.1,
  n.cleveland.iterations = 1,
  blending.coef = 0,
  use.linear.blending = TRUE,
  precision = 1e-06,
  small.depth.threshold = 0.05,
  depth.similarity.tol = 1e-04,
  verbose = FALSE
)
}
\arguments{
\item{x}{Numeric vector of predictor values}

\item{y}{Numeric vector of response values}

\item{grid.size}{Integer specifying the number of grid points (default: 100)}

\item{min.bw.factor}{Numeric minimum bandwidth factor (default: 0.01)}

\item{max.bw.factor}{Numeric maximum bandwidth factor (default: 0.5)}

\item{n.bws}{Integer number of bandwidths to evaluate (default: 30)}

\item{use.global.bw.grid}{Logical: use same bandwidth grid for all points? (default: TRUE)}

\item{with.bw.predictions}{Logical: return predictions for all bandwidths? (default: FALSE)}

\item{log.grid}{Logical: use logarithmic bandwidth spacing? (default: TRUE)}

\item{domain.min.size}{Integer minimum data points per local model (default: 10)}

\item{kernel.type}{Integer code for kernel function (default: 1 = Gaussian)}

\item{dist.normalization.factor}{Numeric scale factor for distances (default: 1)}

\item{n.cleveland.iterations}{Integer robustness iterations (default: 3)}

\item{blending.coef}{Numeric model blending coefficient (default: 0.5)}

\item{use.linear.blending}{Logical: use linear blending? (default: FALSE)}

\item{precision}{Numeric precision threshold for optimization (default: 1e-6)}

\item{small.depth.threshold}{Numeric threshold for wiggle detection (default: 0.05)}

\item{depth.similarity.tol}{Numeric tolerance for depth similarity (default: 0.001)}

\item{verbose}{Logical: print progress information? (default: FALSE)}
}
\value{
A list containing:
\item{x_sorted}{Sorted predictor values}
\item{y_sorted}{Response values ordered by sorted x}
\item{order}{Original indices of sorted data (1-based)}
\item{grid_coords}{x-coordinates of grid points}
\item{predictions}{Fitted values at optimal bandwidth}
\item{bw_predictions}{Matrix of predictions by bandwidth (if requested)}
\item{grid_predictions}{Predictions at grid points}
\item{harmonic_predictions}{Predictions after triplet harmonic smoothing}
\item{local_extrema}{Matrix of detected extrema with columns:
idx (Index in sorted data, 1-based),
x (x-coordinate of extremum),
y (y-value at extremum),
is_max (1 if maximum, 0 if minimum),
depth (Vertical prominence of extremum),
depth_idx (Index where min/max descent terminates, 1-based),
rel_depth (Depth relative to total depth of all extrema),
range_rel_depth (Depth relative to range of predictions)}
\item{monotonic_interval_proportions}{Relative lengths of monotonic intervals}
\item{change_scaled_monotonicity_index}{Weighted signed average of directional changes, quantifying monotonicity strength and directionality; values close to \eqn{+1} or \eqn{-1} indicate strong global monotonic trends.}
\item{bw_errors}{Cross-validation errors for each bandwidth}
\item{opt_bw_idx}{Index of optimal bandwidth (1-based)}
\item{min_bw}{Minimum bandwidth value}
\item{max_bw}{Maximum bandwidth value}
\item{bws}{Vector of evaluated bandwidths}
}
\description{
Performs nonparametric smoothing of 1D data using adaptive model averaged local linear regression.
AMAGELO implements a grid-based approach with model averaging and automatic bandwidth selection
to produce smooth predictions while adapting to local data characteristics. The method also
identifies local extrema and provides measures of their significance.
}
\details{
AMAGELO constructs a uniform grid over the data domain and fits local linear models
at each grid point using a range of bandwidths. Models are then averaged with weights
that depend on both spatial proximity and model quality. The optimal bandwidth is
selected by cross-validation.

The method identifies local extrema (maxima and minima) and calculates their prominence
using both absolute and relative depth measures. It also provides measures of overall
monotonicity through the TVMI and Simpson index.

Triplet harmonic smoothing is applied to remove small wiggles while preserving
significant features of the data.
}
\examples{
\dontrun{
# Simulate data with smooth trend and noise
x <- seq(0, 10, length.out = 200)
y <- sin(x) + 0.2 * rnorm(length(x))

# Apply AMAGELO smoothing
result <- amagelo(x, y, grid_size = 100)

# Plot results
plot(x, y, pch = 16, col = "gray")
lines(x[result$order], result$predictions, col = "red", lwd = 2)

# Examine local extrema
extrema <- result$local_extrema
points(extrema[,"x"], extrema[,"y"],
       pch = ifelse(extrema[,"is_max"] == 1, 24, 25),
       bg = ifelse(extrema[,"is_max"] == 1, "red", "blue"),
       cex = 2 * extrema[,"range_rel_depth"])
}

}
