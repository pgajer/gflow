% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/two_factor_analysis.R
\name{two.factor.analysis}
\alias{two.factor.analysis}
\title{Two-Factor Analysis for Contingency Tables with Proportion Tests}
\usage{
two.factor.analysis(
  y,
  x,
  out.dir,
  latex.file = NULL,
  label = NA,
  do.prop.test = TRUE,
  expected.prop = NULL
)
}
\arguments{
\item{y}{factor, the grouping variable (e.g., treatment groups or community state types)}

\item{x}{factor, the binary outcome variable (e.g., success/failure, case/control)}

\item{out.dir}{character, path to the output directory where results will be saved}

\item{latex.file}{character or NULL, optional path to LaTeX output file. If NULL,
defaults to \code{file.path(out.dir, paste0(label, ".tex"))}}

\item{label}{character or NA, label for output files and LaTeX tables. If NA,
defaults to "fp" for file naming}

\item{do.prop.test}{logical, whether to perform proportion tests (default: TRUE)}

\item{expected.prop}{numeric or NULL, if provided (must be between 0 and 1),
performs one-sample proportion test against this expected value. If NULL,
performs two-sample tests between groups}
}
\value{
A list with the following components:
\describe{
\item{f}{contingency table of frequencies}
\item{p}{matrix of row percentages}
\item{pval}{numeric vector of p-values from proportion tests}
\item{all.f}{formatted results matrix combining percentages, counts, and p-values}
}
}
\description{
Performs comprehensive analysis of contingency tables for two categorical variables,
including proportion tests and optional LaTeX output. Supports both two-sample
proportion comparisons between groups and one-sample tests against expected proportions.
}
\details{
The function performs the following steps:
\enumerate{
\item Validates inputs and creates output directory if needed
\item Constructs contingency table and calculates row proportions
\item Performs proportion tests:
\itemize{
\item If \code{expected.prop} is provided: one-sample tests comparing
each group's proportion to the expected value
\item If \code{expected.prop} is NULL: two-sample tests comparing
each group against all other groups combined
}
\item Formats results combining proportions, counts, and p-values
\item Saves outputs as RDA, CSV, and optionally LaTeX files
}
}
\examples{
\dontrun{
# Create example data
set.seed(123)
treatment <- factor(rep(c("A", "B", "C"), each = 100))
outcome <- factor(rbinom(300, 1, rep(c(0.3, 0.5, 0.4), each = 100)),
                  labels = c("Failure", "Success"))

# Two-sample proportion tests
result <- two.factor.analysis(
  y = treatment,
  x = outcome,
  out.dir = tempdir(),
  label = "treatment_analysis"
)

# One-sample tests against expected proportion of 0.4
result2 <- two.factor.analysis(
  y = treatment,
  x = outcome,
  out.dir = tempdir(),
  label = "treatment_vs_expected",
  expected.prop = 0.4
)
}

}
