% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/graph_gradient_flow_basins.R
\name{lmin.basins}
\alias{lmin.basins}
\title{Identify Basins of Attraction of Local Minima on a Weighted Graph}
\usage{
lmin.basins(adj.list, weight.list = NULL, y, lmin.list, verbose = FALSE)
}
\arguments{
\item{adj.list}{List where \code{adj.list[[i]]} contains indices of vertices
adjacent to vertex i. Must be a valid adjacency list representation.}

\item{weight.list}{List where \code{weight.list[[i]]} contains positive weights
of edges from vertex i to corresponding vertices in \code{adj.list[[i]]}.
If \code{NULL}, uniform weights of 1 are used.}

\item{y}{Numeric vector of values at each vertex. Must have the same length
as \code{adj.list}. Can contain \code{NA} values which are treated as
positive infinity.}

\item{lmin.list}{List where each element contains:
\describe{
\item{\code{lmin}: }{Index of the local minimum vertex}
\item{\code{vertices}: }{Set of vertices forming the initial basin
(usually the local minimum and its neighborhood)}
\item{\code{label}: }{Character label for the basin}
}}

\item{verbose}{Logical; if \code{TRUE}, prints progress messages during
computation. Default is \code{FALSE}.}
}
\value{
A named list of basins of attraction, where names correspond to labels
in \code{lmin.list}. Each element is an integer vector of vertex indices
belonging to that basin, sorted in ascending order.
}
\description{
Computes the basins of attraction for local minima on a weighted graph using
a gradient flow algorithm. Each basin consists of vertices that would flow
towards a particular local minimum following the steepest descent path.
}
\details{
The algorithm expands basins iteratively from local minima by examining boundary
vertices and adding neighboring vertices that satisfy a threshold criterion.
The threshold is computed as a weighted average of values at vertices already
in the basin.

Edge weights influence both the threshold calculation and the decision to
include new vertices. Higher weights indicate stronger connections and give
more influence in the weighted averaging process.

For local minima, vertices are added if their values are above the threshold,
representing flow towards lower values.
}
\examples{
\dontrun{
# Create a weighted graph
adj.list <- list(
  c(2, 3),      # vertex 1 neighbors
  c(1, 3, 4),   # vertex 2 neighbors
  c(1, 2, 5),   # vertex 3 neighbors
  c(2, 5),      # vertex 4 neighbors
  c(3, 4)       # vertex 5 neighbors
)

# Values at vertices
y <- c(0.5, 0.8, 0.3, 1.2, 0.2)

# Define local minima
lmin.list <- list(
  list(lmin = 5, vertices = c(5), label = "min1"),
  list(lmin = 3, vertices = c(3), label = "min2")
)

# Compute basins
basins <- lmin.basins(adj.list, weight.list = NULL, y, lmin.list)
}

}
\seealso{
\code{\link{set.boundary}}, \code{\link{lmax.basins}},
\code{\link{compute.graph.gradient.flow}}
}
