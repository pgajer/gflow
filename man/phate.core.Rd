% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/phate_core.R
\name{phate.core}
\alias{phate.core}
\title{PHATE Core Computation (Kernel -> Diffusion Operator -> Potential Distances)}
\usage{
phate.core(
  X = NULL,
  D = NULL,
  K = NULL,
  P = NULL,
  k = 15L,
  alpha.decay = 40,
  knn.use = TRUE,
  knn.symmetrize = c("mean", "max"),
  t = "auto",
  t.max = 50L,
  pca.dim = NULL,
  pca.center = TRUE,
  pca.scale = FALSE,
  kernel.eps = 1e-12,
  potential.eps = 1e-12,
  compute.D.pot = TRUE,
  verbose = FALSE
)
}
\arguments{
\item{X}{Optional numeric data matrix (rows are observations).}

\item{D}{Optional numeric distance matrix (or \code{dist} object).}

\item{K}{Optional numeric affinity/kernel matrix.}

\item{P}{Optional numeric Markov diffusion operator.}

\item{k}{Integer k-NN neighborhood size for kernel construction from
\code{X} or \code{D}.}

\item{alpha.decay}{Positive kernel decay exponent.}

\item{knn.use}{Logical; if \code{TRUE}, build sparse kNN kernel.}

\item{knn.symmetrize}{Character: \code{"mean"} or \code{"max"} for
symmetrizing directed kNN affinities.}

\item{t}{Either \code{"auto"} or a positive integer diffusion time.}

\item{t.max}{Positive integer maximum diffusion time when \code{t="auto"}.}

\item{pca.dim}{Optional integer. If provided and \code{ncol(X) > pca.dim},
run PCA before distance computation and keep up to \code{pca.dim} PCs.}

\item{pca.center}{Logical; passed to \code{stats::prcomp}.}

\item{pca.scale}{Logical; passed to \code{stats::prcomp}.}

\item{kernel.eps}{Small positive floor for kernel construction.}

\item{potential.eps}{Small positive floor used in \code{-log(P^t)}.}

\item{compute.D.pot}{Logical; if \code{TRUE}, compute \code{D.pot}.}

\item{verbose}{Logical; print progress diagnostics.}
}
\value{
A list of class \code{"phate_core"} with:
\describe{
\item{input_type}{One of \code{"X"}, \code{"D"}, \code{"K"}, \code{"P"}.}
\item{K}{Affinity/kernel matrix used for diffusion (if available).}
\item{P}{Row-stochastic diffusion operator.}
\item{Pt}{Diffusion operator raised to \code{t}.}
\item{U.pot}{Diffusion-potential coordinates \eqn{-\log(P^t)}.}
\item{D.pot}{Pairwise Euclidean distances between rows of \code{U.pot} (optional).}
\item{t}{Diffusion time used.}
\item{diagnostics}{List with entropy curve (for auto-\code{t}),
sparsity summaries, and basic dimensions.}
\item{call}{Matched call.}
}
}
\description{
Minimal native PHATE-style core pipeline for gflow.

Given one of \code{X}, \code{D}, \code{K}, or \code{P}, the function:
\enumerate{
\item Builds an adaptive alpha-decay kernel \code{K} (if needed),
\item Row-normalizes to a Markov diffusion operator \code{P} (if needed),
\item Chooses diffusion time \code{t} (optional automatic selection),
\item Computes \eqn{P^t},
\item Builds diffusion-potential coordinates \code{U.pot = -log(P^t)},
\item Optionally computes pairwise diffusion-potential distances \code{D.pot}.
}

This function focuses on robust, reproducible core quantities that can feed
downstream graph and conditional-expectation workflows in gflow.
}
\examples{
\dontrun{
set.seed(1)
X <- matrix(rnorm(120), ncol = 4)

fit <- phate.core(
  X = X,
  k = 10,
  alpha.decay = 40,
  t = "auto",
  t.max = 30
)

fit$t
fit$diagnostics$t_auto
fit$D.pot[1:5, 1:5]
}

}
