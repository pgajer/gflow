% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pvalue_utils.R
\name{weighted.p.value}
\alias{weighted.p.value}
\title{Weighted P-value Calculation}
\usage{
weighted.p.value(u, mu, sigma, alternative = c("two.sided", "less", "greater"))
}
\arguments{
\item{u}{A numeric vector representing the sample drawn from a distribution
quantifying uncertainty of estimation of a value for which the
p-value is to be computed.}

\item{mu}{The mean of the normal null distribution.}

\item{sigma}{The standard deviation of the normal null distribution.}

\item{alternative}{Character string specifying the alternative hypothesis,
must be one of "two.sided" (default), "greater" or "less".}
}
\value{
A single numeric value representing the weighted p-value.
}
\description{
Computes the weighted p-value for a sample from a distribution quantifying
uncertainty of estimation of a value for which the p-value is to be computed,
given a normal null distribution with specified mean and standard deviation.
The weighted p-value takes into account the uncertainty in the value for
which the classical p-value would normally be computed.
}
\details{
The weighted p-value approach is useful when there is uncertainty in the
test statistic itself. Instead of computing a single p-value based on a
point estimate, this method:
\enumerate{
\item Computes p-values for each value in the uncertainty distribution
\item Averages these p-values to obtain a weighted p-value
}

This approach is particularly valuable in:
\itemize{
\item Bayesian contexts where posterior distributions represent uncertainty
\item Measurement error scenarios
\item Bootstrap or simulation-based inference
}

The weighted p-value can be interpreted as the expected p-value over the
uncertainty distribution of the parameter.
}
\examples{
# Example 1: Uncertainty represented by a normal distribution
u_sample <- rnorm(1000, mean = 1.5, sd = 0.5)

# Test against null hypothesis N(0, 1)
p_value <- weighted.p.value(u_sample, mu = 0, sigma = 1)
cat("Weighted p-value:", p_value, "\n")

# Compare with classical p-value using the mean
classical_p <- pnorm(mean(u_sample), mean = 0, sd = 1, lower.tail = FALSE)
cat("Classical p-value:", classical_p, "\n")

# Example 2: Two-sided test
u_sample2 <- rnorm(1000, mean = -0.5, sd = 0.3)
p_two_sided <- weighted.p.value(u_sample2, mu = 0, sigma = 1,
                                 alternative = "two.sided")
cat("Two-sided weighted p-value:", p_two_sided, "\n")

# Example 3: Using with bootstrap samples
# Simulate some data and bootstrap the mean
set.seed(123)
original_data <- rnorm(30, mean = 1.2, sd = 2)
boot_means <- replicate(1000, mean(sample(original_data, replace = TRUE)))

# Weighted p-value using bootstrap distribution
p_boot <- weighted.p.value(boot_means, mu = 0, sigma = 2/sqrt(30))
cat("Bootstrap-based weighted p-value:", p_boot, "\n")

}
\references{
For theoretical foundations of weighted p-values in the context of
uncertainty quantification, see relevant literature on Bayesian p-values
and posterior predictive checks.
}
