% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mean_shift_smoother.R
\name{adaptive_mean_shift_gfa}
\alias{adaptive_mean_shift_gfa}
\title{Fully Adaptive Mean Shift with Gradient Field Averaging}
\usage{
adaptive_mean_shift_gfa(
  X,
  k,
  density_k,
  n_steps,
  initial_step_size,
  ikernel = 1L,
  dist_normalization_factor = 1.01,
  average_direction_only = FALSE,
  momentum = 0.9,
  increase_factor = 1.2,
  decrease_factor = 0.5
)
}
\arguments{
\item{X}{Numeric matrix (n x d), one row per point.}

\item{k}{Integer > 0, k-NN for gradient estimation (excl. self).}

\item{density_k}{Integer > 0, k-NN for density estimation (excl. self).}

\item{n_steps}{Integer > 0, number of iterations.}

\item{initial_step_size}{Positive numeric, initial per-point step size.}

\item{ikernel}{Integer kernel id; 1=Gaussian, 2=Epanechnikov, 3=Quartic.}

\item{dist_normalization_factor}{Positive numeric distance scaling (default 1.01).}

\item{average_direction_only}{Logical; if TRUE, average directions only.}

\item{momentum}{Numeric in (0,1], influence of previous gradients (default 0.9).}

\item{increase_factor}{Numeric > 1, step growth factor (default 1.2).}

\item{decrease_factor}{Numeric in (0,1), step shrink factor (default 0.5).}
}
\value{
A list with:
\itemize{
\item \code{X_traj}: list of length \code{n_steps+1} (typically),
each an n x d matrix of point positions per iteration.
\item \code{median_kdistances}: numeric vector of median k-distances per step.
}
}
\description{
Implements a fully adaptive mean-shift smoother with gradient-field averaging.
This version adapts both neighborhood selection (kNN recomputed each step)
and per-point step sizes via momentum and step increase/decrease factors.
}
\examples{
set.seed(1)
X <- matrix(rnorm(200), ncol = 2)
out <- adaptive_mean_shift_gfa(
  X, k = 10, density_k = 10, n_steps = 5, initial_step_size = 0.1
)
length(out$X_traj)
}
