% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gflow_cx.R
\name{create.hop.nbhd.extrema.df}
\alias{create.hop.nbhd.extrema.df}
\title{Create Data Frame of Extrema Information from Hop Neighborhoods}
\usage{
create.hop.nbhd.extrema.df(
  result,
  include_spurious = TRUE,
  threshold = NULL,
  sort_by_value = FALSE,
  vertex_column_name = "vertex"
)
}
\arguments{
\item{result}{An object containing hop neighborhood information, typically
from \code{create.gflow.cx()}. Must contain components named
\code{lmin_hop_nbhds} and \code{lmax_hop_nbhds}.}

\item{include_spurious}{Logical; whether to include spurious extrema in the
output. Default is TRUE. Spurious extrema are those with hop index less
than or equal to the threshold.}

\item{threshold}{Numeric scalar specifying the threshold for identifying
spurious extrema. Extrema with hop_idx <= threshold are marked as
spurious. If NULL (default), attempts to extract the threshold from the
result object or uses 2.}

\item{sort_by_value}{Logical; if TRUE, orders extrema by their function
values (ascending for minima, descending for maxima). If FALSE (default),
preserves the original order.}

\item{vertex_column_name}{Character string specifying the name for the vertex
column in the output data frame. Default is "vertex".}
}
\value{
A data frame with the following columns:
\describe{
\item{vertex}{Integer vertex indices (1-based)}
\item{hop_idx}{Numeric hop index values for each extremum}
\item{is_max}{Integer indicator: 0 for minima, 1 for maxima}
\item{label}{Character labels for extrema (e.g., "m1", "m2" for minima,
"M1", "M2" for maxima)}
\item{value}{Numeric function values at extrema (NA if not available)}
\item{spurious}{Logical indicating whether the extremum is spurious}
}

The vertex column may be renamed based on \code{vertex_column_name}.
}
\description{
Extracts and formats extrema information from hop neighborhood results into a
convenient data frame format. This function works with results from
\code{\link{create.gflow.cx}}.
}
\details{
Labels are assigned to extrema based on their function values:
\itemize{
\item Minima are labeled "m1", "m2", etc., in ascending order of function value
\item Maxima are labeled "M1", "M2", etc., in descending order of function value
}

This labeling scheme ensures that "m1" is the global minimum among detected
minima, and "M1" is the global maximum among detected maxima.
}
\examples{
\dontrun{
# Create example graph and compute hop neighborhoods
adj.list <- list(c(2,3), c(1,3,4), c(1,2,4), c(2,3))
weight.list <- list(c(1,1), c(1,1,1), c(1,1,1), c(1,1))
y <- c(0, 1, 0.5, 2)  # Minima at vertices 1,3 and maxima at vertices 2,4

# Using with create.gflow.cx
result <- create.gflow.cx(adj.list, weight.list, y, verbose = FALSE)
extrema_df <- create.hop.nbhd.extrema.df(result)
print(extrema_df)

# Exclude spurious extrema
significant_extrema <- create.hop.nbhd.extrema.df(
  result,
  include_spurious = FALSE,
  threshold = 2
)
print(significant_extrema)
}
}
