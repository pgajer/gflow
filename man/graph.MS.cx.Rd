% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/graph_MS_cx.R
\name{graph.MS.cx}
\alias{graph.MS.cx}
\title{Constructs the Morse-Smale complex of a function defined on graph vertices}
\usage{
graph.MS.cx(graph, hop.list = NULL, core.graph, Ey)
}
\arguments{
\item{graph}{A list representing the graph adjacency list. Each element of
the list should be an integer vector specifying the neighboring vertex
indices for a given vertex. The vertex indices should be 1-based.}

\item{hop.list}{Optional list of hop constraints for gradient flow. If NULL, no
constraints are applied. If provided, should contain hop information
for each vertex.}

\item{core.graph}{A list representing the core graph adjacency list used to constrain
gradient flow paths. Each element should be an integer vector of
1-based neighbor indices.}

\item{Ey}{A numeric vector of function values at vertices.}
}
\value{
An R list of class "graphMScx" with the following components:
\itemize{
\item trajectories: A list where element i contains the gradient flow trajectory
for vertex i (both descending and ascending paths)
\item lmax_to_lmin: A list where element i contains indices of local minima
connected to the i-th local maximum by gradient trajectories
\item lmin_to_lmax: A list where element i contains indices of local maxima
connected to the i-th local minimum by gradient trajectories
\item local_maxima: Integer vector containing indices of all local maxima
\item local_minima: Integer vector containing indices of all local minima
\item procell_keys: List of integer pairs \code{(max_idx, min_idx)} identifying each pro-cell
\item procells: List where element i contains all vertices in the i-th pro-cell
\item cells: List where \code{cells[[i]]} contains the connected components of
pro-cell i after removing its defining extrema
}
}
\description{
Constructs the Morse-Smale complex of a function defined on graph vertices
}
\details{
This function computes gradient flow trajectories and Morse-Smale complex
components for a function Ey defined on vertices of a graph G = pIG_k^h(X).

Key concepts and definitions:
\enumerate{
\item Gradient Flow Trajectories:
\itemize{
\item For each vertex v, computes ascending and descending trajectories
\item Ascending trajectory follows steepest ascent path to local maximum
\item Descending trajectory follows steepest descent path to local minimum
\item Trajectories are constrained to valid paths in core graph pIG_k(X)
}
\item Morse-Smale Pro-cells:
\itemize{
\item A pro-cell is defined by a pair (M,m) where M is a local maximum and m is a local minimum
\item Contains all vertices that lie on gradient trajectories starting at m and ending at M
\item Formally: pro-cell(M,m) = \{v \eqn{\in} V | there exists a trajectory through v from m to M\}
}
\item Morse-Smale Cells:
\itemize{
\item Connected components of pro-cells after removing their defining extrema
\item For pro-cell(M,m), compute components of subgraph induced by:
vertices in pro-cell(M,m) \\ \{M,m\}
\item Unlike classical Morse theory, cells may not be disjoint
}
}

Implementation Overview:
\enumerate{
\item Trajectory Computation:
a. For each vertex v:
\itemize{
\item Compute ascending trajectory following steepest ascent
\item Compute descending trajectory following steepest descent
\item Store endpoints as local extrema
\item Update connectivity maps between extrema
}
\item Pro-cell Construction:
\itemize{
\item During trajectory computation, for each vertex v:
\itemize{
\item If trajectory connects local minimum m to maximum M
\item Add all trajectory vertices to pro-cell(M,m)
}
}
\item Cell Decomposition:
\itemize{
\item For each pro-cell(M,m):
a. Remove M and m from vertex set
b. Compute connected components of remaining subgraph
c. Each component is a Morse-Smale cell
}
}

This function computes the Morse-Smale complex components:
\itemize{
\item Gradient flow trajectories following steepest ascent/descent paths
\item Local extrema (maxima and minima) of the function
\item Morse-Smale pro-cells: sets of vertices whose trajectories flow from
a specific minimum to a specific maximum
\item Morse-Smale cells: connected components of pro-cells with extrema removed
}

The function converts indices between R's 1-based and C++'s 0-based systems.
All returned indices are 1-based following R convention.
}
\note{
Unlike classical Morse-Smale complexes on manifolds, the cells of the
graph Morse-Smale complex may not be disjoint.
}
