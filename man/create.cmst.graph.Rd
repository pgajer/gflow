% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mst_completion_graphs.R
\name{create.cmst.graph}
\alias{create.cmst.graph}
\title{Construct a Minimal Spanning Tree (MST) Completion Graph}
\usage{
create.cmst.graph(
  X,
  q.thld = 0.9,
  pca.dim = 100,
  variance.explained = 0.99,
  verbose = TRUE
)
}
\arguments{
\item{X}{A numeric matrix or data frame of shape \eqn{n \times d}, where
each row represents a data point in d-dimensional space.}

\item{q.thld}{Numeric scalar between 0 and 1 (exclusive). The quantile
threshold for MST completion. Edges are added between points whose
distance is below the q.thld-quantile of MST edge weights. Default is 0.9.}

\item{pca.dim}{Positive integer or NULL. If provided and \code{ncol(X) > pca.dim},
dimensionality is reduced to this many principal components before graph
construction. Must be less than min(n-1, p) where n is the number of
observations and p is the number of variables. Default is 100.}

\item{variance.explained}{Numeric between 0 and 1 (exclusive) or NULL. If
provided, selects the minimal number of PCA components such that this
proportion of total variance is retained (up to \code{pca.dim} components).
Ignored if \code{pca.dim} is NULL. Default is 0.99.}

\item{verbose}{Logical. If \code{TRUE}, prints progress messages during
computation. Default is \code{TRUE}.}
}
\value{
An object of class \code{mst_completion_graph}, which is a list
containing:
\describe{
\item{\code{mst_adj_list}}{A list of length n, where element i contains
the indices of vertices adjacent to vertex i in the MST.}
\item{\code{mst_weight_list}}{A list of length n, where element i
contains the edge weights corresponding to the adjacent vertices in
\code{mst_adj_list[[i]]}.}
\item{\code{cmst_adj_list}}{A list of length n containing adjacency
information for the completed MST graph.}
\item{\code{cmst_weight_list}}{A list of length n containing edge
weights for the completed MST graph.}
\item{\code{mst_edge_weights}}{Numeric vector containing all unique MST
edge weights.}
}

The returned object also has the following attributes:
\describe{
\item{\code{q_thld}}{The quantile threshold used for MST completion.}
\item{\code{pca}}{If PCA was applied, a list containing:
\itemize{
\item \code{original_dim}: The original number of dimensions
\item \code{n_components}: The number of PCA components used
\item \code{variance_explained}: The proportion of variance explained
\item \code{cumulative_variance}: Cumulative variance by component (if applicable)
}
}
\item{\code{call}}{The matched function call.}
}
}
\description{
Constructs a completion of the Minimal Spanning Tree (MST) graph from a
numeric data matrix. The graph is constructed in two steps: first, a MST is
built connecting all data points using minimal total edge length; then,
additional edges are added between any pair of points whose Euclidean
distance lies below a quantile threshold based on the MST edge length
distribution.
}
\details{
The MST completion process enhances connectivity in the original MST by
adding edges between vertices that are "close" according to the distance
distribution in the MST. This can be useful for creating more robust graph
representations of data that maintain local structure while avoiding
long-range connections.

When PCA is applied (either through \code{pca.dim} or \code{variance.explained}),
the data is first centered and projected onto the leading principal components
before graph construction. This can significantly reduce computation time
for high-dimensional data while preserving the most important variation.
}
\examples{
\dontrun{
# Generate sample data
set.seed(123)
X <- matrix(rnorm(100 * 3), nrow = 100, ncol = 3)

# Create MST completion graph with default parameters
graph <- create.cmst.graph(X)

# Create graph with PCA dimensionality reduction
X_high <- matrix(rnorm(100 * 200), nrow = 100, ncol = 200)
graph_pca <- create.cmst.graph(X_high, pca.dim = 50, variance.explained = 0.95)

# Print summary
print(graph_pca)
summary(graph_pca)
}
}
\references{
Gower, J. C., & Ross, G. J. S. (1969). Minimum spanning trees and single
linkage cluster analysis. Applied Statistics, 18(1), 54-64.
}
\seealso{
\code{\link{prcomp}} for principal component analysis,
\code{\link{pca.optimal.components}} for variance-based component selection,
\code{\link{pca.project}} for data projection
}
