% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/stats_utils.R
\name{find.inflection.pts}
\alias{find.inflection.pts}
\title{Finds inflection points of a vector}
\usage{
find.inflection.pts(y, x = NULL, method = c("magelo", "mabilo"))
}
\arguments{
\item{y}{A numeric vector of values for which to find inflection points.}

\item{x}{Optional numeric vector of x-coordinates corresponding to y values.
If NULL (default), uses indices 1:length(y). Must be the same length as y.}

\item{method}{Character string specifying the smoothing method to use. Either "magelo"
(Gaussian error model) or \code{\link{mabilo}} (Binomial error model). Default is "magelo".
Only the first element is used if a vector is provided.}
}
\value{
A list containing:
\itemize{
\item \code{y}: The sorted y values (reordered if x was provided)
\item \code{r0}: Result from the initial smoothing of y
\item \code{r1}: Result from smoothing the first derivative
\item \code{r2}: Result from smoothing the second derivative
\item \code{infl.pts}: Integer indices of inflection points in the sorted data
\item \code{infl.pts.vals}: The y values at the inflection points
}
}
\description{
Identifies inflection points in a numeric vector by computing the second derivative
using either the MAGELO (Monotonic Averaging with Gaussian Error and Linear Order) or
MABILO (Monotonic Averaging with Binomial Error and Linear Order) smoothing methods.
Inflection points are where the second derivative equals zero.
}
\details{
The function uses a three-step process:
\enumerate{
\item Smooths the original data using the specified method
\item Computes and smooths the first derivative (differences of smoothed values)
\item Computes and smooths the second derivative
\item Finds zeros of the second derivative using root-finding
}
If x values are provided, the data is first sorted by x before analysis.
}
\note{
\itemize{
\item Requires the 'rootSolve' package for finding zeros of the second derivative
\item Also requires either the 'magelo' or \code{\link{mabilo}} function to be available
\item The inflection point indices are floored to integers, which may introduce slight imprecision
\item When x is NULL, the function sorts y values, which changes the interpretation of results
}
}
\examples{
\dontrun{
# Example 1: Find inflection points in a sigmoid-like curve
x <- seq(-5, 5, length.out = 100)
y <- 1 / (1 + exp(-x)) + 0.1 * sin(2*x)  # Sigmoid with oscillation

result <- find.inflection.pts(y, x, method = "magelo")

# Plot the results
plot(x, y, type = "l", main = "Inflection Points")
points(x[result$infl.pts], result$infl.pts.vals, col = "red", pch = 19)

# Example 2: Using indices as x-coordinates
y <- c(1, 2, 5, 10, 15, 18, 19, 19.5, 19.8, 20)  # Growth curve
result <- find.inflection.pts(y, method = "mabilo")
print(result$infl.pts)
}
}
\seealso{
\code{\link[rootSolve]{uniroot.all}} for root finding,
\code{magelo} and \code{mabilo} for the smoothing methods
}
