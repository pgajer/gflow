% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/permutation_test_lcor.R
\name{permutation.test.lcor}
\alias{permutation.test.lcor}
\title{Permutation Test for Local Correlation Screening}
\usage{
permutation.test.lcor(
  adj.list,
  weight.list,
  y,
  z,
  type = c("derivative", "unit", "sign"),
  y.diff.type = c("difference", "logratio"),
  z.diff.type = c("difference", "logratio"),
  statistic = c("mean.abs", "mean", "max.abs"),
  permute = c("z", "y"),
  n.perm = 200L,
  seed = 1L,
  return.perm.stats = FALSE,
  verbose = FALSE
)
}
\arguments{
\item{adj.list}{Adjacency list (1-based indices).}

\item{weight.list}{Edge-length (weight) list matching \code{adj.list}.}

\item{y}{Numeric response vector of length \code{n}.}

\item{z}{Numeric feature vector, matrix, or data frame with \code{n} rows.}

\item{type}{Local-correlation weighting mode passed to \code{\link{lcor}}.}

\item{y.diff.type}{Edge difference type for \code{y}; passed to \code{\link{lcor}}.}

\item{z.diff.type}{Edge difference type for \code{z}; passed to \code{\link{lcor}}.}

\item{statistic}{Summary statistic computed per feature from vertex-wise
local-correlation coefficients.
\describe{
\item{"mean.abs"}{Mean absolute local correlation (default).}
\item{"mean"}{Signed mean local correlation.}
\item{"max.abs"}{Maximum absolute local correlation.}
}}

\item{permute}{Permutation target:
\describe{
\item{"z"}{Permute feature rows (default).}
\item{"y"}{Permute response values.}
}}

\item{n.perm}{Integer \eqn{\ge 1}; number of permutations.}

\item{seed}{Optional integer RNG seed. If \code{NULL}, uses current RNG state.}

\item{return.perm.stats}{Logical; if \code{TRUE}, include permutation
statistics matrix in the result.}

\item{verbose}{Logical; if \code{TRUE}, prints progress every 25 permutations.}
}
\value{
A list with class \code{"lcor_permutation_test"} containing:
\describe{
\item{table}{Data frame with feature, observed statistic, p-value, q-value.}
\item{stat.obs}{Named numeric vector of observed statistics.}
\item{p.value}{Named numeric vector of permutation p-values.}
\item{q.value}{Named numeric vector of BH-adjusted p-values.}
\item{statistic}{Statistic definition used.}
\item{permute}{Permutation target used.}
\item{n.perm}{Number of permutations.}
\item{stat.perm}{Permutation statistics matrix (optional).}
}
}
\description{
Performs feature-wise permutation testing for local correlation statistics
computed by \code{\link{lcor}}. By default, vertex labels of feature columns
are permuted (\code{permute = "z"}), which is appropriate for screening
associations between a fixed response field and candidate features.
}
\examples{
\dontrun{
fit <- fit.rdgraph.regression(X, y, k = 10)
y.hat <- fit$fitted.values

res <- permutation.test.lcor(
  adj.list = fit$graph$adj.list,
  weight.list = fit$graph$edge.length.list,
  y = y.hat,
  z = Z,
  type = "derivative",
  statistic = "mean.abs",
  permute = "z",
  n.perm = 200,
  seed = 1
)

head(res$table[order(res$table$q.value), ])
}
}
