% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/agemalo.R
\name{agemalo}
\alias{agemalo}
\title{Adaptive Graph Geodesic Model-Averaged Local Linear Regression}
\usage{
agemalo(
  adj.list,
  weight.list,
  y,
  min.path.size = 6,
  n.packing.vertices = length(y),
  max.packing.iterations = 20,
  packing.precision = 1e-04,
  n.bws = 50,
  log.grid = TRUE,
  min.bw.factor = 0.025,
  max.bw.factor = 0.99,
  dist.normalization.factor = 1.1,
  kernel.type = 7L,
  model.tolerance = 1e-06,
  model.blending.coef = 0.1,
  n.bb = 0L,
  cri.probability = 0.95,
  n.perms = 0L,
  verbose = FALSE
)
}
\arguments{
\item{adj.list}{List of integer vectors. Each vector contains indices of vertices
adjacent to the corresponding vertex. Indices should be 1-based.}

\item{weight.list}{List of numeric vectors. Each vector contains weights of edges
corresponding to adjacencies in adj.list.}

\item{y}{Numeric vector of response values at each vertex.}

\item{min.path.size}{Integer. Minimum number of vertices required in valid paths.}

\item{n.packing.vertices}{Integer. Number of vertices to use in the maximal packing.
Defaults to the number of vertices (length of y).}

\item{max.packing.iterations}{Integer. Maximum number of iterations for the packing algorithm.}

\item{packing.precision}{Numeric. Precision threshold for packing convergence.}

\item{n.bws}{Integer. Number of candidate bandwidths to evaluate.}

\item{log.grid}{Logical. Whether to use logarithmic spacing for bandwidth candidates.}

\item{min.bw.factor}{Numeric. Factor multiplied by graph diameter for minimum bandwidth.}

\item{max.bw.factor}{Numeric. Factor multiplied by graph diameter for maximum bandwidth.}

\item{dist.normalization.factor}{Numeric. Factor for normalizing graph distances.}

\item{kernel.type}{Integer. Type of kernel function (1-7, with 7 as default).}

\item{model.tolerance}{Numeric. Convergence tolerance for model fitting.}

\item{model.blending.coef}{Numeric. Blending coefficient for model averaging.}

\item{n.bb}{Integer. Number of bootstrap iterations (0 for no bootstrap).}

\item{cri.probability}{Numeric. Confidence level for bootstrap intervals (0-1).}

\item{n.perms}{Integer. Number of permutation test iterations (0 for no testing).}

\item{verbose}{Logical. Whether to print progress information.}
}
\value{
A list containing:
\item{graph.diameter}{Numeric. Computed diameter of input graph.}
\item{grid.opt.bw}{Numeric vector. Optimal bandwidth for each grid vertex.}
\item{predictions}{Numeric vector. Model-averaged predictions for original vertices.}
\item{grid.predictions}{Numeric vector. Model-averaged predictions for grid vertices.}
\item{bb.predictions}{Matrix. Bootstrap predictions (if n.bb > 0).}
\item{cri.lower}{Numeric vector. Lower confidence bounds (if n.bb > 0).}
\item{cri.upper}{Numeric vector. Upper confidence bounds (if n.bb > 0).}
\item{null.predictions}{Matrix. Permutation test predictions (if n.perms > 0).}
\item{p.values}{Numeric vector. Vertex-wise p-values (if n.perms > 0).}
\item{effect.sizes}{Numeric vector. Effect sizes (if n.perms > 0).}
\item{significant.vertices}{Logical vector. Significance indicators (if n.perms > 0).}
}
\description{
Performs geodesic model-averaged local linear regression on
graph-structured data using an adaptive uniform grid approach.
}
\details{
The AGEMALO algorithm proceeds through several steps:
\enumerate{
\item Creates a maximal packing of the input graph
\item For each packing vertex it
}
\itemize{
\item creates a hierarchy of local geodesics passing through that vertex
\item computes minimal and maximal bandwidths and bandwidth candidates
\item fits local weighted linear models along geodesic paths
}
\enumerate{
\item Combines predictions using model averaging
}

The function supports optional bootstrap confidence intervals and permutation testing
for statistical inference.
}
\examples{
\dontrun{
# Create a simple graph with 3 vertices
adj.list <- list(c(2), c(1, 3), c(2))
weight.list <- list(c(1), c(1, 1), c(1))
y <- c(1, 2, 3)

# Run basic analysis
result <- agemalo(
  adj.list = adj.list,
  weight.list = weight.list,
  y = y,
  min.path.size = 2,
  n.packing.vertices = 5,
  n.bws = 10
)

# Run with bootstrap confidence intervals
result.boot <- agemalo(
  adj.list = adj.list,
  weight.list = weight.list,
  y = y,
  min.path.size = 2,
  n.packing.vertices = 5,
  n.bws = 10,
  n.bb = 100
)
}

}
