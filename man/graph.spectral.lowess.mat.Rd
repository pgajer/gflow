% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/graph_spectral_lowess_mat.R
\name{graph.spectral.lowess.mat}
\alias{graph.spectral.lowess.mat}
\title{Matrix version of Spectral Graph Local Polynomial Regression}
\usage{
graph.spectral.lowess.mat(
  adj.list,
  weight.list,
  Y,
  n.evectors = 5,
  n.bws = 20,
  log.grid = FALSE,
  min.bw.factor = 0.01,
  max.bw.factor = 0.5,
  dist.normalization.factor = 1.1,
  kernel.type = 7L,
  precision = 1e-06,
  n.cleveland.iterations = 0L,
  with.errors = FALSE,
  with.scale = FALSE,
  verbose = TRUE
)
}
\arguments{
\item{adj.list}{List where each element contains indices of adjacent vertices}

\item{weight.list}{List where each element contains weights of adjacent edges}

\item{Y}{Matrix or list of numeric vectors where each column/element represents
a response variable at each vertex}

\item{n.evectors}{Number of eigenvectors to use for spectral embedding}

\item{n.bws}{Number of candidate bandwidths to evaluate (default: 20)}

\item{log.grid}{Logical; whether to use logarithmic spacing for bandwidth grid (default: FALSE)}

\item{min.bw.factor}{Factor for minimum bandwidth as fraction of graph diameter (default: 0.01)}

\item{max.bw.factor}{Factor for maximum bandwidth as fraction of graph diameter (default: 0.5)}

\item{dist.normalization.factor}{Factor for normalizing distances (default: 1.1)}

\item{kernel.type}{Integer indicating kernel type: 0=gaussian, 1=epanechnikov, etc. (default: 7)}

\item{precision}{Precision threshold for numerical calculations (default: 1e-6)}

\item{n.cleveland.iterations}{Number of iterations for Cleveland's robust fitting (default: 3)}

\item{with.errors}{Logical; whether to compute prediction errors (default: FALSE)}

\item{with.scale}{Logical; whether to compute bandwidth scales (default: FALSE)}

\item{verbose}{Logical; whether to print progress information (default: TRUE)}
}
\value{
A list with components:
\item{predictions}{Matrix where each column contains smoothed values for a response variable}
\item{errors}{Matrix of prediction errors (if with.errors=TRUE)}
\item{scale}{Matrix of local bandwidth scales (if with.scale=TRUE)}
}
\description{
Performs locally weighted regression for multiple response variables simultaneously
on a graph structure using spectral embeddings. This function is more efficient than
applying the standard \code{graph_spectral_lowess} to each response variable separately, as
it computes the graph Laplacian and eigenvectors only once.
}
\details{
This function efficiently handles multiple response variables by leveraging the fact that
the graph structure processing (Laplacian calculation, spectral decomposition) only needs
to be performed once. For each vertex, it identifies an appropriate neighborhood, creates
a spectral embedding, and fits robust linear models for each response variable within
this embedding space.

The optimal bandwidth is selected independently for each response variable at each vertex,
balancing between overfitting (small bandwidth) and underfitting (large bandwidth).
}
\examples{
\dontrun{
# Create sample graph
n <- 100
g <- make.example.graph(n)

# Create multiple response variables (e.g., 3 columns)
Y <- matrix(rnorm(n*3), ncol=3)

# Apply spectral lowess to all columns at once
result <- graph.spectral.lowess.mat(g$adj.list, g$weight.list, Y)

# Plot results for first response variable
plot(Y[,1], result$predictions[,1], main="Original vs. Smoothed (Var 1)")
abline(0, 1, col="red", lty=2)
}

}
