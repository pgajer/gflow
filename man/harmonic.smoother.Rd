% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/harmonic_smoother.R
\name{harmonic.smoother}
\alias{harmonic.smoother}
\title{Perform Harmonic Smoothing with Topology Tracking}
\usage{
harmonic.smoother(
  adj.list,
  weight.list,
  values,
  region.vertices,
  max.iterations = 100,
  tolerance = 1e-06,
  record.frequency = 1,
  stability.window = 3,
  stability.threshold = 0.05
)
}
\arguments{
\item{adj.list}{A list of integer vectors, where each vector contains indices
of vertices adjacent to the corresponding vertex. Indices must be
1-based.}

\item{weight.list}{A list of numeric vectors containing weights of edges
corresponding to adjacencies in \code{adj.list}.}

\item{values}{A numeric vector of function values defined at each vertex.}

\item{region.vertices}{An integer vector of vertex indices (1-based) defining
the region to be smoothed. Boundary vertices will have fixed values.}

\item{max.iterations}{Integer scalar, the maximum number of relaxation
iterations to perform. Default is 100.}

\item{tolerance}{Numeric scalar, the convergence threshold for value changes.
Default is 1e-6.}

\item{record.frequency}{Integer scalar, how often to record states (every N
iterations). Default is 1 (record every iteration).}

\item{stability.window}{Integer scalar, number of consecutive iterations to
check for topological stability. Default is 3.}

\item{stability.threshold}{Numeric scalar in \eqn{[0,1]}, maximum allowed
difference in topology to consider stable. Default is 0.05.}
}
\value{
A list of class \code{"harmonic_smoother"} containing:
\item{harmonic_predictions}{Numeric vector of smoothed function values}
\item{i_harmonic_predictions}{Matrix of function values at each recorded
iteration (columns are iterations)}
\item{i_basins}{List of matrices representing extrema at each iteration}
\item{stable_iteration}{Integer indicating the iteration at which topology
stabilized}
\item{topology_differences}{Numeric vector of differences between consecutive
recorded iterations}
}
\description{
Applies harmonic smoothing to function values defined on vertices of a graph
while tracking how the topological structure (local extrema and their basins)
evolves during the smoothing process. This helps identify the optimal level
of smoothing that reduces noise while preserving significant features.
}
\details{
This function extends standard harmonic smoothing by monitoring the evolution
of local extrema during the iterative process. It identifies a "sweet spot"
where the topological structure stabilizes, indicating that noise has been
removed without over-flattening important features.

The algorithm:
\enumerate{
\item Iteratively performs harmonic smoothing on interior vertices
\item Periodically identifies local extrema and their basins
\item Monitors the stability of the topological structure
\item Identifies when the topological structure stabilizes
}

The function returns comprehensive information about the smoothing process,
including all intermediate states and the detected stability point.
}
\examples{
\dontrun{
# Create a simple grid graph
grid.graph <- create.graph.from.grid(10, 10)

# Create noisy function values
values <- sin(0.1 * seq_len(100)) + rnorm(100, 0, 0.1)

# Define a region for smoothing (center of the grid)
region <- 35:65

# Apply harmonic smoothing with topology tracking
result <- harmonic.smoother(
  grid.graph$adj.list,
  grid.graph$weight.list,
  values,
  region,
  max.iterations = 200,
  tolerance = 1e-8,
  record.frequency = 5,  # Record every 5 iterations
  stability.window = 3,
  stability.threshold = 0.05
)

# Get the smoothed values
smoothed.values <- result$harmonic_predictions

# Plot original vs smoothed values
plot(values, type = "l", col = "gray")
lines(smoothed.values, col = "red")

# Plot the evolution of topology differences
plot(result$topology_differences, type = "l",
     xlab = "Iteration", ylab = "Topology Difference")
abline(v = result$stable_iteration, col = "blue", lty = 2)
}

}
\seealso{
\code{\link{perform.harmonic.smoothing}} for basic smoothing,
\code{\link{plot.harmonic_smoother}} for visualization methods,
\code{\link{summary.harmonic_smoother}} for summary statistics
}
