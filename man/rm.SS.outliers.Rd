% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/stats_utils.R
\name{rm.SS.outliers}
\alias{rm.SS.outliers}
\title{Remove outliers from a state space}
\usage{
rm.SS.outliers(
  S,
  y = NULL,
  p = 0.98,
  dist.factor = 100,
  K = 30,
  method = "diff.dist.factor"
)
}
\arguments{
\item{S}{A numeric matrix or data frame representing the state space,
where rows are observations and columns are dimensions.}

\item{y}{An optional numeric vector of length \code{nrow(S)} representing
a variable defined over the state space. Default is NULL.}

\item{p}{Numeric between 0 and 1. The percentile threshold for outlier removal.
Default value of 0.98 removes samples whose distance to the nearest neighbor
is greater than the 98th percentile of all nearest neighbor distances.}

\item{dist.factor}{A positive numeric constant used for outlier selection.
For method "dist.factor", points with ratio of furthest to nearest neighbor
distance exceeding this value are considered outliers. For method
"diff.dist.factor", points with relative jump in neighbor distances
exceeding this value are considered outliers. Default is 100.}

\item{K}{Integer specifying the number of nearest neighbors to use for
outlier identification. Must be positive. Default is 30.}

\item{method}{Character string specifying the outlier detection method when K > 1.
Options are:
\itemize{
\item "diff.dist.factor" (default): Uses the maximum jump in consecutive
neighbor distances relative to the median jump.
\item "dist.factor": Uses the ratio of the K-th to 1st neighbor distance.
\item Any other value: Uses a threshold-based approach on all neighbor distances.
}}
}
\value{
A list containing:
\item{S.q}{The filtered state space with outliers removed}
\item{y.q}{The filtered y variable (NULL if y was NULL)}
\item{nn.d}{The K-nearest neighbor distance matrix from the original data}
\item{d.thld}{The distance threshold used (p-th percentile)}
\item{idx}{Logical vector indicating which observations were kept (TRUE) or
removed as outliers (FALSE)}
}
\description{
Removes outliers from a state space (SS) and optionally from a variable
defined over it using k-nearest neighbor distances.
}
\examples{
\dontrun{
# Create example data
set.seed(123)
S <- matrix(rnorm(200), ncol = 2)
y <- rnorm(100)

# Remove outliers
result <- rm.SS.outliers(S, y, p = 0.95)

# Check how many points were removed
sum(!result$idx)
}

}
\seealso{
\code{\link[FNN]{get.knn}} for K-nearest neighbor computation
}
